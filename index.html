<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sualtƒ± Akademisi - PROFESYONEL</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700;900&display=swap');

        :root {
            --primary: #FF6F00;
            --secondary: #0288D1;
            --accent: #00E676;
            --bg-grad: linear-gradient(135deg, #E0F7FA 0%, #81D4FA 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Nunito', sans-serif;
            background: var(--bg-grad);
            height: 100vh; overflow: hidden;
            display: flex; justify-content: center; align-items: center;
            user-select: none;
        }

        /* --- ARKA PLAN (Baloncuklar) --- */
        .bubble {
            position: absolute; bottom: -50px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%; pointer-events: none;
            animation: rise 10s infinite ease-in; z-index: 0;
        }
        @keyframes rise {
            0% { bottom: -50px; transform: translateX(0); }
            100% { bottom: 120vh; transform: translateX(20px); }
        }

        /* --- ANA KUTU --- */
        #app-container {
            width: 95%; max-width: 1000px; height: 95vh;
            background: var(--card-bg);
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,50,0.2);
            display: flex; flex-direction: column;
            overflow: hidden; position: relative; z-index: 10;
            border: 4px solid #fff;
        }

        /* --- HEADER --- */
        header {
            padding: 15px 25px; background: white;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); z-index: 20;
        }
        .user-badge { display: flex; align-items: center; gap: 10px; font-weight: bold; color: #546E7A; font-size: 1.2rem; }
        .score-badge { background: #FFF8E1; color: #FF8F00; padding: 5px 15px; border-radius: 20px; font-family: 'Fredoka One'; border: 2px solid #FFECB3; }

        /* --- SAHNELER --- */
        .scene {
            flex: 1; display: none;
            flex-direction: column; align-items: center; justify-content: center;
            text-align: center; padding: 10px; overflow-y: auto;
        }
        .scene.active { display: flex !important; animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        /* --- UI ELEMENTLERƒ∞ --- */
        h1, h2 { font-family: 'Fredoka One', cursive; margin: 10px 0; color: #0277BD; }
        
        .btn {
            background: linear-gradient(180deg, #FFCA28 0%, #FF6F00 100%);
            border: none; border-bottom: 5px solid #E65100;
            color: white; padding: 12px 30px; font-size: 1.3rem;
            font-family: 'Fredoka One', cursive; border-radius: 50px;
            cursor: pointer; transition: 0.1s; margin: 5px;
        }
        .btn:active { transform: translateY(4px); border-bottom-width: 2px; }
        .btn-home { background: #B0BEC5; border-bottom-color: #78909C; font-size: 1rem; padding: 8px 20px; }

        /* --- MEN√ú KARTLARI --- */
        .menu-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; width: 90%; padding: 10px; }
        .game-card {
            background: white; border-radius: 20px; padding: 15px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); cursor: pointer;
            transition: 0.2s; border: 3px solid transparent;
            display: flex; flex-direction: column; align-items: center;
        }
        .game-card:hover { transform: translateY(-5px); border-color: var(--secondary); }
        .game-icon { font-size: 50px; margin-bottom: 5px; }
        .game-name { font-weight: bold; color: #455A64; }

        /* --- OYUN ALANI --- */
        .game-area { width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; }
        .card-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 20px; }
        
        .play-card {
            width: 90px; height: 90px; background: white; border-radius: 15px;
            border: 3px solid #E0E0E0; box-shadow: 0 5px 0 #cfd8dc;
            display: flex; align-items: center; justify-content: center;
            font-size: 50px; cursor: pointer; transition: 0.2s; position: relative;
        }
        .play-card:active { transform: translateY(5px); box-shadow: none; }
        .play-card.correct { background: #C8E6C9; border-color: #4CAF50; color: #2E7D32; pointer-events: none; }
        .play-card.wrong { background: #FFCDD2; border-color: #F44336; animation: shake 0.4s; }
        
        /* G√ñLGE EFEKTƒ∞ (D√ºzeltildi) */
        .silhouette { filter: brightness(0); opacity: 0.8; pointer-events: none; }

        /* ROBOT GRID */
        .robot-grid { display: grid; gap: 5px; background: #E1F5FE; padding: 10px; border-radius: 15px; margin-bottom: 10px; }
        .robot-cell { background: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 30px; }

        /* MEMORY CARD */
        .mem-card { background: #0288D1; color: transparent; transform: rotateY(0deg); transition: 0.3s; }
        .mem-card.flipped { background: white; color: black; transform: rotateY(180deg); }

        @keyframes shake { 0%,100% {transform:translateX(0)} 25% {transform:translateX(-5px)} 75% {transform:translateX(5px)} }
        #confetti-canvas { position: absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:99; }
    </style>
</head>
<body>

<div id="bubbles-container"></div>
<canvas id="confetti-canvas"></canvas>

<div id="app-container">
    <header id="main-header" style="display:none;">
        <div class="user-badge"><span id="u-avatar"></span> <span id="u-name"></span></div>
        <div class="score-badge">‚≠ê <span id="u-score">0</span></div>
        <button class="btn btn-home" onclick="goMenu()">üè† Men√º</button>
    </header>

    <div id="scene-char" class="scene active">
        <h1>Sualtƒ± Akademisi</h1>
        <p>Merhaba! Kiminle oynamak istersin?</p>
        <div style="display:flex; gap:20px; margin-top:20px;">
            <div class="game-card" onclick="selectChar('Deniz', 'male')">
                <div style="font-size:80px">üë¶</div>
                <h3>Deniz</h3>
            </div>
            <div class="game-card" onclick="selectChar('Mercan', 'female')">
                <div style="font-size:80px">üëß</div>
                <h3>Mercan</h3>
            </div>
        </div>
    </div>

    <div id="scene-menu" class="scene">
        <h2>Oyun Se√ßimi</h2>
        <div class="menu-grid" id="menu-container"></div>
    </div>

    <div id="scene-game" class="scene">
        <div style="color:#90A4AE; font-weight:bold;">Seviye <span id="lvl-txt">1</span> / 5</div>
        <h2 id="game-instr">Y√∂nerge</h2>
        
        <div id="game-board" class="game-area"></div>

        <div id="robot-ctrl" style="display:none; margin-top:10px;">
            <div style="display:grid; grid-template-columns: repeat(3, 70px); gap:5px;">
                <div></div><button class="btn" onclick="moveRobot(0,-1)">‚¨Ü</button><div></div>
                <button class="btn" onclick="moveRobot(-1,0)">‚¨Ö</button><div></div><button class="btn" onclick="moveRobot(1,0)">‚û°</button>
                <div></div><button class="btn" onclick="moveRobot(0,1)">‚¨á</button><div></div>
            </div>
        </div>
    </div>

    <div id="scene-win" class="scene">
        <div style="font-size:100px; animation: pop 0.5s;">üåü</div>
        <h1>Harikasƒ±n!</h1>
        <p>B√∂l√ºm Tamamlandƒ±</p>
        <button class="btn" onclick="nextLevel()">Devam Et ‚ñ∂</button>
    </div>
</div>

<script>
    /* --- SES & TTS MOTORU (Hatasƒ±z) --- */
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playTone(freq, type) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        osc.type = type; osc.frequency.value = freq;
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
        osc.start(); osc.stop(audioCtx.currentTime + 0.2);
    }
    
    function sfxClick() { playTone(400, 'triangle'); }
    function sfxError() { playTone(150, 'sawtooth'); }
    function sfxWin() { 
        playTone(500, 'sine'); 
        setTimeout(()=>playTone(700, 'sine'), 100); 
        setTimeout(()=>playTone(900, 'sine'), 200); 
    }

    function speak(text) {
        if('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(text);
            u.lang = 'tr-TR';
            window.speechSynthesis.speak(u);
        }
    }

    /* --- OYUN VERƒ∞LERƒ∞ --- */
    const ASSETS = ['ü¶Ä','üê¨','üêô','üê¢','üê†','üêö','üê≥','ü¶à','üê°','ü¶ê'];
    const GAMES = [
        { id: 'shadow', name: 'G√∂lge Avƒ±', icon: 'üïµÔ∏è' },
        { id: 'robot', name: 'Robot Yenge√ß', icon: 'ü¶Ä' },
        { id: 'paint', name: 'Renk Ustasƒ±', icon: 'üé®' },
        { id: 'count', name: 'Saymaca', icon: 'üî¢' },
        { id: 'memory', name: 'Hafƒ±za', icon: 'üß†' },
        { id: 'diff', name: 'Farkƒ± Bul', icon: 'üëÄ' },
        { id: 'sort', name: 'Sƒ±ralama', icon: 'üìè' },
        { id: 'pattern', name: '√ñr√ºnt√º', icon: 'üîÑ' }
    ];

    let gameState = {
        charName: '', 
        score: 0, 
        level: 1, 
        gameId: null,
        // Robot oyunu i√ßin
        player: {x:0,y:0}, target:{x:0,y:0}, rocks:[],
        // Memory oyunu i√ßin
        flippedCards: [], lockBoard: false
    };

    /* --- G√ñRSEL --- */
    function initBubbles() {
        const c = document.getElementById('bubbles-container');
        for(let i=0; i<10; i++) {
            let b = document.createElement('div'); b.className='bubble';
            b.style.left = Math.random()*100 + '%';
            b.style.width = b.style.height = (Math.random()*40+10)+'px';
            b.style.animationDuration = (Math.random()*5+5)+'s';
            b.style.animationDelay = (Math.random()*5)+'s';
            c.appendChild(b);
        }
    }
    
    function fireConfetti() {
        const c = document.getElementById('confetti-canvas'); const cx=c.getContext('2d');
        c.width=window.innerWidth; c.height=window.innerHeight;
        let p=[]; for(let i=0;i<60;i++)p.push({x:Math.random()*c.width,y:Math.random()*c.height-c.height,c:`hsl(${Math.random()*360},100%,50%)`,v:Math.random()*5+2});
        function loop(){cx.clearRect(0,0,c.width,c.height);let a=false;p.forEach(x=>{x.y+=x.v;if(x.y<c.height){a=true;cx.fillStyle=x.c;cx.fillRect(x.x,x.y,10,10)}});if(a)requestAnimationFrame(loop);}loop();
    }

    /* --- NAVƒ∞GASYON --- */
    function switchScene(id) {
        document.querySelectorAll('.scene').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        const head = document.getElementById('main-header');
        if(id === 'scene-menu' || id === 'scene-game') head.style.display = 'flex'; else head.style.display = 'none';
    }

    function selectChar(name, gender) {
        gameState.charName = name;
        document.getElementById('u-name').innerText = name;
        document.getElementById('u-avatar').innerText = gender==='male'?'üë¶':'üëß';
        
        const mc = document.getElementById('menu-container'); mc.innerHTML='';
        GAMES.forEach(g => {
            let d = document.createElement('div'); d.className='game-card';
            d.innerHTML = `<div class="game-icon">${g.icon}</div><div class="game-name">${g.name}</div>`;
            d.onclick = () => initGame(g.id);
            mc.appendChild(d);
        });
        
        speak("Ho≈ügeldin " + name);
        switchScene('scene-menu');
    }

    function goMenu() { switchScene('scene-menu'); }

    /* --- OYUN MOTORU --- */
    function initGame(id) {
        gameState.gameId = id; gameState.level = 1;
        loadLevel();
        switchScene('scene-game');
    }

    function nextLevel() {
        if(gameState.level < 5) {
            gameState.level++;
            loadLevel();
            switchScene('scene-game');
        } else {
            speak("Tebrikler! Bu oyunu bitirdin.");
            fireConfetti();
            goMenu();
        }
    }

    function levelWin() {
        sfxWin(); 
        gameState.score += gameState.level * 10;
        document.getElementById('u-score').innerText = gameState.score;
        speak("Aferin! Harika.");
        switchScene('scene-win');
    }

    function loadLevel() {
        const board = document.getElementById('game-board');
        const instr = document.getElementById('game-instr');
        const robotCtrl = document.getElementById('robot-ctrl');
        
        board.innerHTML = ''; robotCtrl.style.display = 'none';
        document.getElementById('lvl-txt').innerText = gameState.level;

        const lvl = gameState.level;
        const game = gameState.gameId;

        // 1. G√ñLGE AVI (Shadow) - D√úZELTƒ∞LDƒ∞
        if(game === 'shadow') {
            instr.innerText = "G√∂lgeyi Bul"; speak("Bu g√∂lge hangisine ait?");
            let target = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            
            // G√∂lge Hedefi (Simsiyah Siluet)
            let tDiv = document.createElement('div');
            tDiv.style.fontSize='100px'; 
            tDiv.innerHTML = `<div class="silhouette">${target}</div>`;
            board.appendChild(tDiv);

            // Se√ßenekler
            let opts = [target];
            while(opts.length < 2+lvl) {
                let r = ASSETS[Math.floor(Math.random()*ASSETS.length)];
                if(!opts.includes(r)) opts.push(r);
            }
            opts.sort(()=>Math.random()-0.5);

            let grid = document.createElement('div'); grid.className='card-grid';
            opts.forEach(o => {
                let c = document.createElement('div'); c.className='play-card'; c.innerText = o;
                c.onclick = () => {
                    if(o===target) { c.classList.add('correct'); setTimeout(levelWin,800); }
                    else { sfxError(); c.classList.add('wrong'); speak("Yanlƒ±≈ü"); }
                };
                grid.appendChild(c);
            });
            board.appendChild(grid);
        }

        // 2. ROBOT YENGE√á (Kodlama)
        else if(game === 'robot') {
            instr.innerText = "Yƒ±ldƒ±za Git"; speak("Oklarƒ± kullanarak yƒ±ldƒ±za ula≈ü.");
            robotCtrl.style.display = 'block';
            let size = 3 + Math.floor(lvl/2); // Grid boyutu
            let grid = document.createElement('div'); grid.className='robot-grid';
            grid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            
            gameState.player = {x:0, y:0};
            gameState.target = {x:size-1, y:size-1};
            gameState.rocks = [];
            
            // Rastgele kaya
            for(let i=0; i<lvl; i++) {
                let rx=Math.floor(Math.random()*size), ry=Math.floor(Math.random()*size);
                if((rx!==0||ry!==0) && (rx!==gameState.target.x||ry!==gameState.target.y)) gameState.rocks.push({x:rx,y:ry});
            }

            gameState.renderGrid = () => {
                grid.innerHTML = '';
                for(let y=0; y<size; y++) for(let x=0; x<size; x++) {
                    let d = document.createElement('div'); d.className='robot-cell';
                    d.style.width=d.style.height=(250/size)+'px';
                    if(x===gameState.player.x && y===gameState.player.y) d.innerText='ü¶Ä';
                    else if(x===gameState.target.x && y===gameState.target.y) d.innerText='‚≠ê';
                    else if(gameState.rocks.some(r=>r.x===x&&r.y===y)) d.innerText='ü™®';
                    grid.appendChild(d);
                }
            };
            gameState.renderGrid();
            board.appendChild(grid);
        }

        // 3. RENK USTASI
        else if(game === 'paint') {
            const cols = [{c:'#F44336',n:'Kƒ±rmƒ±zƒ±'},{c:'#2196F3',n:'Mavi'},{c:'#FFEB3B',n:'Sarƒ±'},{c:'#4CAF50',n:'Ye≈üil'},{c:'#9C27B0',n:'Mor'},{c:'#FF9800',n:'Turuncu'}];
            let t = cols[Math.floor(Math.random()*cols.length)];
            instr.innerText = t.n + " Rengi Bul"; speak(t.n + " kutuyu bul.");
            
            let grid = document.createElement('div'); grid.className='card-grid';
            let opts = [t];
            while(opts.length < Math.min(6, lvl+2)) {
                let r = cols[Math.floor(Math.random()*cols.length)];
                if(!opts.includes(r)) opts.push(r);
            }
            opts.sort(()=>Math.random()-0.5);
            
            opts.forEach(c => {
                let d = document.createElement('div'); d.className='play-card'; d.style.background=c.c;
                d.onclick = () => {
                    if(c.c===t.c) { d.innerText='‚úî'; setTimeout(levelWin,800); }
                    else { sfxError(); d.style.opacity='0.5'; speak("Yanlƒ±≈ü"); }
                };
                grid.appendChild(d);
            });
            board.appendChild(grid);
        }

        // 4. HAFIZA (Memory)
        else if(game === 'memory') {
            instr.innerText = "E≈üini Bul"; speak("Kartlarƒ± a√ß ve e≈üini bul.");
            let pairs = lvl + 1;
            let items = [];
            for(let i=0; i<pairs; i++) items.push(ASSETS[i]);
            let deck = [...items, ...items];
            deck.sort(()=>Math.random()-0.5);
            
            gameState.flippedCards = []; gameState.lockBoard = false;
            let matched = 0;

            let grid = document.createElement('div'); grid.className='card-grid';
            deck.forEach((item, idx) => {
                let card = document.createElement('div'); card.className='play-card mem-card';
                card.dataset.val = item;
                card.innerHTML = '‚ùì';
                
                card.onclick = () => {
                    if(gameState.lockBoard || card.classList.contains('flipped')) return;
                    
                    card.classList.add('flipped'); card.innerHTML = item;
                    gameState.flippedCards.push(card);
                    sfxClick();

                    if(gameState.flippedCards.length === 2) {
                        gameState.lockBoard = true;
                        let c1 = gameState.flippedCards[0];
                        let c2 = gameState.flippedCards[1];

                        if(c1.dataset.val === c2.dataset.val) {
                            matched++; sfxWin();
                            gameState.flippedCards = []; gameState.lockBoard = false;
                            if(matched === pairs) setTimeout(levelWin, 1000);
                        } else {
                            sfxError();
                            setTimeout(() => {
                                c1.classList.remove('flipped'); c1.innerHTML='‚ùì';
                                c2.classList.remove('flipped'); c2.innerHTML='‚ùì';
                                gameState.flippedCards = []; gameState.lockBoard = false;
                            }, 1000);
                        }
                    }
                };
                grid.appendChild(card);
            });
            board.appendChild(grid);
        }

        // 5. SAYMACA (Count)
        else if(game === 'count') {
            let n = Math.floor(Math.random()*(lvl*2))+2;
            let item = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            instr.innerText = "Ka√ß Tane Var?"; speak(`Burada ka√ß tane ${item} var?`);
            
            let box = document.createElement('div');
            box.style.display='flex'; box.style.flexWrap='wrap'; box.style.justifyContent='center'; box.style.width='300px';
            for(let i=0; i<n; i++) box.innerHTML += `<div style="font-size:40px; margin:5px;">${item}</div>`;
            board.appendChild(box);

            let grid = document.createElement('div'); grid.className='card-grid';
            let opts = [n];
            while(opts.length < 3) {
                let r = n + Math.floor(Math.random()*5)-2;
                if(r>0 && !opts.includes(r)) opts.push(r);
            }
            opts.sort(()=>Math.random()-0.5);
            
            opts.forEach(x => {
                let c = document.createElement('div'); c.className='play-card'; c.innerText=x;
                c.onclick = () => {
                    if(x===n) { c.classList.add('correct'); setTimeout(levelWin,800); }
                    else { sfxError(); c.classList.add('wrong'); }
                };
                grid.appendChild(c);
            });
            board.appendChild(grid);
        }

        // 6. FARKI BUL (Difference)
        else if(game === 'diff') {
            instr.innerText = "Farklƒ± Olanƒ± Bul"; speak("Hangisi diƒüerlerinden farklƒ±?");
            let normal = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            let odd = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            while(odd===normal) odd = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            
            let count = 3 + lvl;
            let oddIdx = Math.floor(Math.random()*count);
            let grid = document.createElement('div'); grid.className='card-grid';
            
            for(let i=0; i<count; i++) {
                let c = document.createElement('div'); c.className='play-card';
                c.innerText = (i===oddIdx) ? odd : normal;
                c.onclick = () => {
                    if(i===oddIdx) { c.classList.add('correct'); setTimeout(levelWin,800); }
                    else { sfxError(); c.classList.add('wrong'); }
                };
                grid.appendChild(c);
            }
            board.appendChild(grid);
        }

        // 7. SIRALAMA (Sort)
        else if(game === 'sort') {
            instr.innerText = "K√º√ß√ºkten B√ºy√ºƒüe"; speak("Sayƒ±larƒ± sƒ±rayla se√ß.");
            let nums = [];
            while(nums.length < lvl+2) {
                let r = Math.floor(Math.random()*20)+1;
                if(!nums.includes(r)) nums.push(r);
            }
            let sorted = [...nums].sort((a,b)=>a-b);
            let currentIdx = 0;
            
            let grid = document.createElement('div'); grid.className='card-grid';
            nums.forEach(n => {
                let c = document.createElement('div'); c.className='play-card'; c.innerText=n;
                c.onclick = () => {
                    if(n === sorted[currentIdx]) {
                        c.classList.add('correct'); c.style.visibility='hidden';
                        currentIdx++; sfxClick();
                        if(currentIdx >= sorted.length) setTimeout(levelWin, 500);
                    } else {
                        sfxError(); c.classList.add('wrong'); setTimeout(()=>c.classList.remove('wrong'), 500);
                    }
                };
                grid.appendChild(c);
            });
            board.appendChild(grid);
        }

        // 8. √ñR√úNT√ú (Pattern)
        else if(game === 'pattern') {
            instr.innerText = "Sƒ±rada Ne Var?"; speak("Sƒ±radaki ≈üekil hangisi?");
            let a = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            let b = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            while(b===a) b = ASSETS[Math.floor(Math.random()*ASSETS.length)];
            
            // √ñrn: A B A B ? -> Cevap A
            let seq = [a,b,a,b]; 
            let ans = a;
            
            let disp = document.createElement('div');
            disp.style.fontSize='50px'; disp.style.marginBottom='20px';
            disp.innerText = seq.join(' ') + ' ‚ùì';
            board.appendChild(disp);

            let grid = document.createElement('div'); grid.className='card-grid';
            let opts = [ans, b];
            opts.sort(()=>Math.random()-0.5);
            
            opts.forEach(o => {
                let c = document.createElement('div'); c.className='play-card'; c.innerText=o;
                c.onclick = () => {
                    if(o===ans) { c.classList.add('correct'); setTimeout(levelWin,800); }
                    else { sfxError(); c.classList.add('wrong'); }
                };
                grid.appendChild(c);
            });
            board.appendChild(grid);
        }
    }

    // --- ROBOT HAREKET FONKSƒ∞YONU ---
    window.moveRobot = (dx, dy) => {
        let p = gameState.player, t = gameState.target, s = 3 + Math.floor(gameState.level/2);
        let nx = p.x+dx, ny = p.y+dy;
        
        // √áarpma kontrol√º
        if(nx<0 || ny<0 || nx>=s || ny>=s || gameState.rocks.some(r=>r.x===nx&&r.y===ny)) {
            sfxError(); speak("√áarptƒ±k!"); return;
        }
        
        gameState.player = {x:nx, y:ny}; sfxClick(); gameState.renderGrid();
        if(nx===t.x && ny===t.y) setTimeout(levelWin, 500);
    }

    // Ba≈ülangƒ±√ß animasyonlarƒ±
    window.onload = initBubbles;

</script>
</body>
</html>
